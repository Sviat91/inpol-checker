# –ê—Ç–æ–º–∞—Ä–Ω—ã–π –≤—ã–±–æ—Ä –æ—á–µ—Ä–µ–¥–∏ - —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

## üêõ –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞

Material Design dropdown **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è** —á–µ—Ä–µ–∑ ~1 —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è.

**–ë—ã–ª–æ:**
```python
expand_queues()      # –û—Ç–∫—Ä—ã–ª–∏ dropdown
queues = get_queues()  # –ü—Ä–æ—á–∏—Ç–∞–ª–∏ —Å–ø–∏—Å–æ–∫
# ... —Ç—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Ä–µ–º—è ...
select_queue(queue)  # ‚ùå Dropdown –£–ñ–ï –ó–ê–ö–†–´–¢!
```

**–í—Ä–µ–º—è –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:** ~2-3 —Å–µ–∫—É–Ω–¥—ã ‚Üí dropdown –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ê—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–ª –º–µ—Ç–æ–¥ `select_first_queue_atomic()` –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –í–°–Å –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑:

```python
def select_first_queue_atomic(self):
    # 1. –û—Ç–∫—Ä—ã—Ç—å dropdown
    click(queue_dropdown)
    
    # 2. –°–†–ê–ó–£ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (dropdown –æ—Ç–∫—Ä—ã—Ç)
    elements = get_elements()
    queues = [el.text for el in elements if el.text != '-']
    
    # 3. –°–†–ê–ó–£ –∫–ª–∏–∫–Ω—É—Ç—å –ø–æ –ø–µ—Ä–≤–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É (–∏—Å–ø–æ–ª—å–∑—É—è —É–∂–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π element!)
    for el in elements:
        if el.text == queues[0]:
            click(el)  # ‚úÖ Dropdown –µ—â–µ –æ—Ç–∫—Ä—ã—Ç!
            return queues[0]
```

**–í—Ä–µ–º—è –º–µ–∂–¥—É –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∏ –∫–ª–∏–∫–æ–º:** < 0.5 —Å–µ–∫—É–Ω–¥ ‚Üí dropdown –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç—å—Å—è

## üìä –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### 1. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ `lib/checker.py`
```python
select_first_queue_atomic()
```
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç dropdown
- –ß–∏—Ç–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—á–µ—Ä–µ–¥–µ–π
- –ö–ª–∏–∫–∞–µ—Ç –ø–æ –ø–µ—Ä–≤–æ–π –æ—á–µ—Ä–µ–¥–∏
- –í—Å—ë –∑–∞ < 1 —Å–µ–∫—É–Ω–¥—É!

### 2. –û–±–Ω–æ–≤–ª–µ–Ω `run_staged_multi_loop_wh.py`
**–ë—ã–ª–æ:**
```python
expand_queues()
queues = get_queues()
select_queue(queues[0])
```

**–°—Ç–∞–ª–æ:**
```python
queue = select_first_queue_atomic()  # –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞!
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω `test_checker_simple.py`
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥.

### 4. –û–±–Ω–æ–≤–ª–µ–Ω `debug_dropdown.py`
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥.

## üéØ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
```python
# –ù–µ –¥–µ–ª–∞–µ–º –≤—Ç–æ—Ä–æ–π –ø–æ–∏—Å–∫:
# queue_option = find_element(xpath)  ‚ùå

# –ö–ª–∏–∫–∞–µ–º –ø–æ —É–∂–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É:
for el in queue_elements:  # ‚úÖ –£–∂–µ –≤ –ø–∞–º—è—Ç–∏
    if el.text == queue_name:
        click(el)
```

### 2. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
```python
time.sleep(rand.uniform(1, 2))  # –ë—ã–ª–æ 2-5 —Å–µ–∫
```

### 3. Fallback –Ω–∞ –ø–æ–∏—Å–∫
```python
# –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–∞–ª stale, –∏—â–µ–º –∑–∞–Ω–æ–≤–æ
if not_found_in_cached:
    queue_option = find_element(xpath)
    click(queue_option)
```

## üîß –ö–∞–∫ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker
docker compose down

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
docker compose build --no-cache

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker compose up

# –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞:
python debug_dropdown.py
```

## üìù –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

**–£—Å–ø–µ—Ö:**
```
[INFO] === Checking location: Al. Jerozolimskie 28 ===
[INFO] location selection (Al. Jerozolimskie 28)
[INFO] open list of queues (atomic operation)
[INFO] Found queue: F - Wnioski o POBYT CZASOWY...
[INFO] queue selection (F - Wnioski o POBYT CZASOWY...)
[INFO] waiting for calendar to load...
[INFO] Calendar loaded successfully
[INFO] 15 enabled cells in NOVEMBER 2024
```

**–ù–µ—Ç –æ—á–µ—Ä–µ–¥–∏:**
```
[INFO] open list of queues (atomic operation)
[WARNING] No queues found in dropdown
[WARNING] ‚ö†Ô∏è No queues available for location "..." - skipping
```

## ‚ö° –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Dropdown –æ—Ç–∫—Ä—ã—Ç** ‚Üí –ø–æ–ª—É—á–∞–µ–º WebElement –æ–±—ä–µ–∫—Ç—ã
2. **–°—Ä–∞–∑—É —Ñ–∏–ª—å—Ç—Ä—É–µ–º** ‚Üí –Ω–∞—Ö–æ–¥–∏–º –Ω—É–∂–Ω—É—é –æ—á–µ—Ä–µ–¥—å
3. **–ö–ª–∏–∫–∞–µ–º –ø–æ –æ–±—ä–µ–∫—Ç—É** ‚Üí –Ω–µ –∏—â–µ–º –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ XPath
4. **–í—Å—ë –∑–∞ < 1 —Å–µ–∫** ‚Üí dropdown –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç—å—Å—è

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ Dropdown –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–ª–∏–∫–æ–º
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚úÖ Fallback –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç stale
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ç–æ–º–∞—Ä–Ω—ã–π –º–µ—Ç–æ–¥ –≤–º–µ—Å—Ç–æ 3 —Ä–∞–∑–¥–µ–ª—å–Ω—ã—Ö
