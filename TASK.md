# –ü–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –±–æ—Ç–∞

## üéØ –î–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç –∫–∞–ø—á—É
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
**–°—Ç–∞—Ç—É—Å:** –õ–æ–≥–∏–∫–∞ –ø–æ–Ω—è—Ç–Ω–∞, –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üìã –ó–∞–¥–∞—á–∞ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞—Ç—ã (–ü–†–ò–û–†–ò–¢–ï–¢!)

### –ü—Ä–æ–±–ª–µ–º–∞:
–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è:
```python
# ‚ùå –°–µ–π—á–∞—Å:
last_date = valid_cells[-1]  # –ü—Ä–æ—Å—Ç–æ –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É
if is_end_of_month(last_date):  # –ï—Å–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 –¥–Ω—è—Ö
    check_next_month()
```

**–ß—Ç–æ –Ω–µ —Ç–∞–∫:**
- –î–∞—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ **~6 –Ω–µ–¥–µ–ª—å** –≤–ø–µ—Ä–µ–¥
- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω **–∏–¥—Ç–∏ –¥–æ —Å–∞–º–æ–π –¥–∞–ª—å–Ω–µ–π –¥–∞—Ç—ã**, –ø—Ä–æ–ø—É—Å–∫–∞—è –º–µ—Å—è—Ü—ã –≥–¥–µ –ø–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ = –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
- –°–µ–π—á–∞—Å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:

#### –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
```python
def get_last_working_day_of_month(year, month):
    """
    –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ (–ø—Ä–æ–ø—É—Å–∫–∞—è –≤—ã—Ö–æ–¥–Ω—ã–µ).
    
    –ù–∞–ø—Ä–∏–º–µ—Ä:
    - –û–∫—Ç—è–±—Ä—å 2025: –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å 31 (–ø—è—Ç–Ω–∏—Ü–∞) ‚Üí 31
    - –ù–æ—è–±—Ä—å 2025: –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å 30 (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ), 29 (—Å—É–±–±–æ—Ç–∞) ‚Üí 28 (–ø—è—Ç–Ω–∏—Ü–∞)
    - –î–µ–∫–∞–±—Ä—å 2025: –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å 31 (—Å—Ä–µ–¥–∞) ‚Üí 31
    """
    last_day = calendar.monthrange(year, month)[1]
    
    # –ò–¥–µ–º –Ω–∞–∑–∞–¥ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–Ω—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
    for day in range(last_day, 0, -1):
        weekday = datetime(year, month, day).weekday()
        if weekday < 5:  # Mon-Fri
            return day
    
    return last_day  # Fallback
```

#### –®–∞–≥ 2: –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –¥–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∫–∞–ª–µ–Ω–¥–∞—Ä—è
2. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã (–∏–≥–Ω–æ—Ä–∏—Ä—É—è –≤—ã—Ö–æ–¥–Ω—ã–µ)
3. –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–∞—Ç—É (last_available_date)
4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ (last_working_day)

5. –ï–°–õ–ò last_available_date == last_working_day:
   ‚Üí –≠—Ç–æ –∑–Ω–∞—á–∏—Ç –¥–∞—Ç—ã –∏–¥—É—Ç –¥–∞–ª—å—à–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
   ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
   ‚Üí GOTO —à–∞–≥ 2
   
6. –ò–ù–ê–ß–ï last_available_date < last_working_day:
   ‚Üí –ú—ã –Ω–∞—à–ª–∏ —Å–∞–º—É—é –¥–∞–ª—å–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–∞—Ç—É!
   ‚Üí –≠—Ç–æ –Ω–∞—à–∞ –¥–∞—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
   ‚Üí STOP –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —ç—Ç—É –¥–∞—Ç—É
```

#### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–∫—Ç—è–±—Ä—å 2025**
```
–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: PA≈π 2025 (–û–∫—Ç—è–±—Ä—å)
–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã (–±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö): [1, 2, 3, ..., 29, 30, 31]
–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞: 31 (–ø—è—Ç–Ω–∏—Ü–∞)
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞: 31 (–ø—è—Ç–Ω–∏—Ü–∞)

31 == 31 ‚Üí –ò–¥–µ–º –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü!
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–æ—è–±—Ä—å 2025**
```
–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: LIS 2025 (–ù–æ—è–±—Ä—å)
–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã (–±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö): [3, 4, 5, ..., 26, 27, 28]
–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞: 28 (–ø—è—Ç–Ω–∏—Ü–∞)
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞: 28 (–ø—è—Ç–Ω–∏—Ü–∞, —Ç.–∫. 29 —Å–±, 30 –≤—Å)

28 == 28 ‚Üí –ò–¥–µ–º –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü!
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –î–µ–∫–∞–±—Ä—å 2025**
```
–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: GRU 2025 (–î–µ–∫–∞–±—Ä—å)
–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã: []
–ù–µ—Ç –¥–∞—Ç!

‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü (–ù–æ—è–±—Ä—å)
‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É: 28 LIS 2025
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–æ—è–±—Ä—å (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)**
```
–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: LIS 2025 (–ù–æ—è–±—Ä—å)
–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã (–±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö): [3, 4, 5, ..., 26, 27]
–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞: 27 (—á–µ—Ç–≤–µ—Ä–≥)
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞: 28 (–ø—è—Ç–Ω–∏—Ü–∞)

27 < 28 ‚Üí –≠—Ç–æ –Ω–∞—à–∞ –¥–∞—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏!
‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ–º 27 LIS 2025 –°–†–ê–ó–£, –Ω–µ –∏–¥–µ–º –≤ –¥–µ–∫–∞–±—Ä—å
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

#### –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `find_furthest_available_date()`:
```python
def find_furthest_available_date(self):
    """
    –ù–∞–π—Ç–∏ —Å–∞–º—É—é –¥–∞–ª—å–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–∞—Ç—É (–¥–æ 6 –Ω–µ–¥–µ–ª—å –≤–ø–µ—Ä–µ–¥).
    
    –ê–ª–≥–æ—Ä–∏—Ç–º:
    1. –ù–∞—á–∏–Ω–∞–µ–º —Å —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
    2. –ü–æ–∫–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞ == –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞:
       - –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
    3. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–µ—Å—è—Ü + –¥–∞—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    """
    max_months_to_check = 3  # –ú–∞–∫—Å 3 –º–µ—Å—è—Ü–∞ –≤–ø–µ—Ä–µ–¥ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
    
    for month_offset in range(max_months_to_check):
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ –æ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ
        month_year_text = get_current_month()
        enabled_cells = get_enabled_dates()
        
        if len(enabled_cells) == 0:
            # –ù–µ—Ç –¥–∞—Ç –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ
            if month_offset > 0:
                # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞–∑–∞–¥
                click_prev_month()
                return get_last_available_date()
            else:
                # –ù–µ—Ç –¥–∞—Ç –≤–æ–æ–±—â–µ
                return None
        
        # –§–∏–ª—å—Ç—Ä—É–µ–º –≤—ã—Ö–æ–¥–Ω—ã–µ
        valid_cells = [cell for cell in enabled_cells 
                       if not is_weekend(cell.text, month_year_text)]
        
        if len(valid_cells) == 0:
            continue
        
        # –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞
        last_available_date = int(valid_cells[-1].text)
        
        # –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
        year, month = parse_month_year(month_year_text)
        last_working_day = get_last_working_day_of_month(year, month)
        
        logging.info(f'Month: {month_year_text}, Last available: {last_available_date}, '
                     f'Last working day: {last_working_day}')
        
        if last_available_date == last_working_day:
            # –î–∞—Ç—ã –∏–¥—É—Ç –¥–∞–ª—å—à–µ, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
            logging.info(f'Last date {last_available_date} matches last working day '
                         f'{last_working_day}, checking next month...')
            click_next_month()
            continue
        else:
            # –ù–∞—à–ª–∏ –¥–∞—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏!
            logging.info(f'Found date to check: {last_available_date} {month_year_text} '
                         f'(not end of month)')
            return {
                'cell': valid_cells[-1],
                'date': last_available_date,
                'month_year': month_year_text,
                'months_forward': month_offset
            }
    
    # –î–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ –º–µ—Å—è—Ü–µ–≤
    logging.warning(f'Reached max months ({max_months_to_check}), using last available')
    return {
        'cell': valid_cells[-1],
        'date': int(valid_cells[-1].text),
        'month_year': month_year_text,
        'months_forward': max_months_to_check
    }
```

#### –û–±–Ω–æ–≤–∏—Ç—å `check_last_date_only()`:
```python
def check_last_date_only(self, location, queue):
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    load_calendar()
    
    # –ò—â–µ–º —Å–∞–º—É—é –¥–∞–ª—å–Ω—é—é –¥–∞—Ç—É (–ø—Ä–æ—Ö–æ–¥—è –ø–æ –º–µ—Å—è—Ü–∞–º)
    date_info = self.find_furthest_available_date()
    
    if date_info is None:
        logging.warning('No dates available at all')
        return None
    
    # –ö–ª–∏–∫–∞–µ–º –ø–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –¥–∞—Ç–µ
    logging.info(f'‚úÖ Checking FURTHEST date: {date_info["date"]} {date_info["month_year"]}')
    human_click(date_info['cell'])
    wait_spinner()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–ø—á—É
    detect_captcha()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–æ—Ç—ã
    check_slots()
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –Ω–∞—á–∞–ª—å–Ω—ã–π –º–µ—Å—è—Ü (–µ—Å–ª–∏ —É—Ö–æ–¥–∏–ª–∏ –≤–ø–µ—Ä–µ–¥)
    if date_info['months_forward'] > 0:
        for _ in range(date_info['months_forward']):
            click_prev_month()
    
    return slots_found
```

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã:

```python
class Checker:
    def __init__(self, config):
        self.config = config
        self.human = HumanBehavior(config.browser)
        self._cached_check_date = None  # –ö–µ—à –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
    
    def find_furthest_available_date(self):
        # –ï—Å–ª–∏ —É–∂–µ –Ω–∞—à–ª–∏ –¥–∞—Ç—É –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à
        if self._cached_check_date is not None:
            logging.info(f'Using cached date: {self._cached_check_date["date"]} '
                         f'{self._cached_check_date["month_year"]}')
            
            # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –Ω—É–∂–Ω–æ–º—É –º–µ—Å—è—Ü—É
            target_month = self._cached_check_date['months_forward']
            for _ in range(target_month):
                click_next_month()
            
            # –ù–∞—Ö–æ–¥–∏–º —Ç—É –∂–µ –¥–∞—Ç—É
            enabled_cells = get_enabled_dates()
            valid_cells = filter_weekends(enabled_cells)
            target_date = self._cached_check_date['date']
            
            for cell in valid_cells:
                if int(cell.text) == target_date:
                    return {
                        'cell': cell,
                        'date': target_date,
                        'month_year': get_current_month(),
                        'months_forward': target_month
                    }
        
        # –ò–Ω–∞—á–µ –∏—â–µ–º –¥–∞—Ç—É –∑–∞–Ω–æ–≤–æ
        date_info = self._find_furthest_date_uncached()
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à (–±–µ–∑ WebElement, —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ)
        self._cached_check_date = {
            'date': date_info['date'],
            'month_year': date_info['month_year'],
            'months_forward': date_info['months_forward']
        }
        
        return date_info
```

### –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `get_last_working_day_of_month(year, month)`
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å `parse_month_year(month_year_text)` ‚Üí (year, month)
3. ‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `find_furthest_available_date()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ `_cached_check_date`
5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `check_last_date_only()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
7. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –¢–µ—Å—Ç—ã:

**–¢–µ—Å—Ç 1: –î–∞—Ç—ã –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞**
```
–û–∫—Ç—è–±—Ä—å: 1-31 (31 = –ø—è—Ç–Ω–∏—Ü–∞)
‚Üí –ò–¥–µ–º –≤ –Ω–æ—è–±—Ä—å
–ù–æ—è–±—Ä—å: 1-28 (28 = –ø—è—Ç–Ω–∏—Ü–∞, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π)
‚Üí –ò–¥–µ–º –≤ –¥–µ–∫–∞–±—Ä—å
–î–µ–∫–∞–±—Ä—å: –Ω–µ—Ç –¥–∞—Ç
‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è, –ø—Ä–æ–≤–µ—Ä—è–µ–º 28 –Ω–æ—è–±—Ä—è
```

**–¢–µ—Å—Ç 2: –î–∞—Ç—ã –ù–ï –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞**
```
–û–∫—Ç—è–±—Ä—å: 1-30 (30 = —á–µ—Ç–≤–µ—Ä–≥, 31 = –ø—è—Ç–Ω–∏—Ü–∞)
‚Üí 30 < 31, –ø—Ä–æ–≤–µ—Ä—è–µ–º 30 –æ–∫—Ç—è–±—Ä—è –°–†–ê–ó–£
```

**–¢–µ—Å—Ç 3: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```
–ê–¥—Ä–µ—Å 1: –ò—â–µ–º –¥–∞—Ç—É ‚Üí 28 –Ω–æ—è–±—Ä—è ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à
–ê–¥—Ä–µ—Å 2: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à ‚Üí 28 –Ω–æ—è–±—Ä—è (–±–µ–∑ –ø–æ–∏—Å–∫–∞!)
–ê–¥—Ä–µ—Å 3: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à ‚Üí 28 –Ω–æ—è–±—Ä—è (–±–µ–∑ –ø–æ–∏—Å–∫–∞!)
```

---

## üìã –ó–∞–¥–∞—á–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫–∞–ø—á–∏ (–í–¢–û–†–ê–Ø –ü–†–ò–û–†–ò–¢–ï–¢)

### –ü—Ä–æ–±–ª–µ–º–∞:
–ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç –∫–∞–ø—á—É, —Ö–æ—Ç—è –æ–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è (–≤–∏–¥–Ω–æ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ).

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

#### –ü—Ä–∏—á–∏–Ω–∞ 1: –ö–Ω–æ–ø–∫–∞ –≤ iframe
```python
# –í–æ–∑–º–æ–∂–Ω–æ –∫–Ω–æ–ø–∫–∞ #proceed-button –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –í–ù–£–¢–†–ò iframe
# –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ iframe –ø–µ—Ä–µ–¥ –ø–æ–∏—Å–∫–æ–º

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
iframe = browser.find_element(By.CSS_SELECTOR, "iframe[src*='akamai']")
browser.switch_to.frame(iframe)
proceed_button = browser.find_element(By.ID, "proceed-button")
browser.switch_to.default_content()
```

#### –ü—Ä–∏—á–∏–Ω–∞ 2: –≠–ª–µ–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
```python
# –ö–Ω–æ–ø–∫–∞ –º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
# –ù—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π

click_date()
time.sleep(0.5-1.0)  # –î–∞–µ–º –≤—Ä–µ–º—è –∫–∞–ø—á–µ –ø–æ—è–≤–∏—Ç—å—Å—è
detect_captcha()
```

#### –ü—Ä–∏—á–∏–Ω–∞ 3: –≠–ª–µ–º–µ–Ω—Ç –µ—Å—Ç—å, –Ω–æ –Ω–µ–≤–∏–¥–∏–º –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Selenium
```python
# –ú–æ–∂–µ—Ç –±—ã—Ç—å element.is_displayed() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç False
# –Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ —ç–ª–µ–º–µ–Ω—Ç –≤–∏–¥–∏–º

# –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:
proceed_button = find_element("#proceed-button")
if proceed_button:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ is_displayed, –Ω–æ –∏ —Ä–∞–∑–º–µ—Ä—ã
    size = proceed_button.size
    location = proceed_button.location
    opacity = proceed_button.value_of_css_property('opacity')
    z_index = proceed_button.value_of_css_property('z-index')
    
    logging.debug(f'Proceed button: size={size}, loc={location}, '
                  f'opacity={opacity}, z-index={z_index}')
```

#### –ü—Ä–∏—á–∏–Ω–∞ 4: –°–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
```python
# –ú–æ–∂–µ—Ç –±—ã—Ç—å ID –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–ª–∏ –∞—Ç—Ä–∏–±—É—Ç—ã –¥—Ä—É–≥–∏–µ
# –ù—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –ø–æ –¥—Ä—É–≥–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
# 1. –ü–æ —Ç–µ–∫—Å—Ç—É –∫–Ω–æ–ø–∫–∏
buttons = browser.find_elements(By.XPATH, "//button[contains(., 'Kontynuuj')]")

# 2. –ü–æ –∫–ª–∞—Å—Å—É
buttons = browser.find_elements(By.CSS_SELECTOR, "button.btn, div.btn")

# 3. –ü–æ onclick
buttons = browser.find_elements(By.XPATH, 
    "//button[@onclick='AKCPT.behavioral_verify()'] | "
    "//div[@onclick='AKCPT.behavioral_verify()']")
```

### –ü–ª–∞–Ω –æ—Ç–ª–∞–¥–∫–∏ –∫–∞–ø—á–∏:

#### –≠—Ç–∞–ø 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)
```python
# –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ detect_captcha():

def detect_captcha(self):
    logging.debug('=== CAPTCHA DETECTION START ===')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ iframe
    iframes = browser.find_elements(By.TAG_NAME, 'iframe')
    logging.debug(f'Total iframes on page: {len(iframes)}')
    for i, iframe in enumerate(iframes):
        src = iframe.get_attribute('src') or ''
        logging.debug(f'  Iframe {i}: src="{src}", displayed={iframe.is_displayed()}')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º proceed-button –≤ main context
    proceed_buttons = browser.find_elements(By.ID, 'proceed-button')
    logging.debug(f'Proceed buttons in main context: {len(proceed_buttons)}')
    for btn in proceed_buttons:
        logging.debug(f'  Button: displayed={btn.is_displayed()}, '
                      f'size={btn.size}, text="{btn.text}"')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º proceed-button –≤ –∫–∞–∂–¥–æ–º iframe
    for i, iframe in enumerate(iframes):
        try:
            browser.switch_to.frame(iframe)
            proceed_buttons = browser.find_elements(By.ID, 'proceed-button')
            logging.debug(f'Proceed buttons in iframe {i}: {len(proceed_buttons)}')
            for btn in proceed_buttons:
                logging.debug(f'  Button: displayed={btn.is_displayed()}, '
                              f'size={btn.size}, text="{btn.text}"')
            browser.switch_to.default_content()
        except Exception as e:
            logging.debug(f'Error checking iframe {i}: {e}')
            browser.switch_to.default_content()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª—é–±—ã–µ –∫–Ω–æ–ø–∫–∏ —Å "Kontynuuj"
    kontynuuj_buttons = browser.find_elements(By.XPATH, "//*[contains(., 'Kontynuuj')]")
    logging.debug(f'Elements with "Kontynuuj": {len(kontynuuj_buttons)}')
    for btn in kontynuuj_buttons:
        logging.debug(f'  Element: tag={btn.tag_name}, displayed={btn.is_displayed()}, '
                      f'text="{btn.text}"')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º AKCPT –≤ page source
    page_source = browser.page_source
    if 'AKCPT' in page_source:
        logging.debug('AKCPT found in page source!')
        if 'behavioral_verify' in page_source:
            logging.debug('behavioral_verify() found in page source!')
    
    logging.debug('=== CAPTCHA DETECTION END ===')
```

#### –≠—Ç–∞–ø 2: –ù–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥–¥–µ –∫–Ω–æ–ø–∫–∞
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç —Å LOG_LEVEL=DEBUG
- –î–æ–∂–¥–∞—Ç—å—Å—è –∫–∞–ø—á–∏
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏
- –ü–æ–Ω—è—Ç—å –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è #proceed-button

#### –≠—Ç–∞–ø 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥–µ—Ç–µ–∫—Ü–∏—é
–ù–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≠—Ç–∞–ø–∞ 2:
- –ï—Å–ª–∏ –≤ iframe ‚Üí –¥–æ–±–∞–≤–∏—Ç—å switch_to.frame
- –ï—Å–ª–∏ –¥—Ä—É–≥–æ–π —Å–µ–ª–µ–∫—Ç–æ—Ä ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä
- –ï—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –æ–∂–∏–¥–∞–Ω–∏–µ

### –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏):

1. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `detect_captcha()`
2. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç, –¥–æ–∂–¥–∞—Ç—å—Å—è –∫–∞–ø—á–∏
3. ‚è≥ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å DEBUG –ª–æ–≥–∏
4. ‚è≥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞
5. ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `detect_captcha()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
6. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

### –§–∞–∑–∞ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –¥–∞—Ç (–ù–ê–ß–ê–¢–¨ –° –≠–¢–û–ì–û!)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `get_last_working_day_of_month()`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `parse_month_year()`
3. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `find_furthest_available_date()`
4. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
5. –û–±–Ω–æ–≤–∏—Ç—å `check_last_date_only()`
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 2: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–ø—á–∏
1. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –∫–∞–ø—á–∏
3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏
4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ

### –§–∞–∑–∞ 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø—á–∏ (–ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
1. –û–±–Ω–æ–≤–∏—Ç—å `detect_captcha()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:

| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è |
|--------|-----------|-----------|-------|
| –õ–æ–≥–∏–∫–∞ –¥–∞—Ç | üî¥ HIGH | –°—Ä–µ–¥–Ω—è—è | 30-60 –º–∏–Ω |
| –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ | üü° MEDIUM | –ù–∏–∑–∫–∞—è | 15 –º–∏–Ω |
| –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–ø—á–∏ | üî¥ HIGH | –ù–∏–∑–∫–∞—è | 10 –º–∏–Ω + –æ–∂–∏–¥–∞–Ω–∏–µ |
| –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø—á–∏ | üî¥ HIGH | –ù–∏–∑–∫–∞—è-–°—Ä–µ–¥–Ω—è—è | 15-30 –º–∏–Ω |

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:

### –ó–∞–¥–∞—á–∞ 1 (–î–∞—Ç—ã):
- ‚úÖ –ë–æ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –º–µ—Å—è—Ü—ã –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ—Ç —Å–∞–º—É—é –¥–∞–ª—å–Ω—é—é –¥–∞—Ç—É
- ‚úÖ –ë–æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
- ‚úÖ –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ 1 –¥–∞—Ç—É –∑–∞ —Ü–∏–∫–ª
- ‚úÖ –ö–µ—à —Ä–∞–±–æ—Ç–∞–µ—Ç - –¥–∞—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è 1 —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ –¥–∞—Ç—ã

### –ó–∞–¥–∞—á–∞ 2 (–ö–∞–ø—á–∞):
- ‚úÖ –ë–æ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∫–∞–ø—á—É –∫–æ–≥–¥–∞ –æ–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- ‚úÖ –ë–æ—Ç –¥–µ–ª–∞–µ—Ç –ø–∞—É–∑—É 2 –º–∏–Ω—É—Ç—ã
- ‚úÖ –ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É

---

## üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Å –ó–∞–¥–∞—á–∏ 1!

–ì–æ—Ç–æ–≤ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞—Ç—ã.
